---
- name: üõ† –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  hosts: monitoring
  become: yes
  vars:

    # –ü–æ–ª—É—á–∞–µ–º —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ Vault
    aws_creds: >-
      {{
        lookup('hashi_vault',
          'secret=secret/data/ansible/aws ' +
          'token=' + lookup('env', 'VAULT_TOKEN') + ' ' +
          'url=' + lookup('env', 'VAULT_ADDR') + ' ' +
          'engine_version=2'
        )
      }}

    # –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    aws_region: "{{ aws_creds.AWS_REGION }}"
    ecr_account: "{{ aws_creds.ECR_ACCOUNT }}"
    aws_access_key_id: "{{ aws_creds.AWS_ACCESS_KEY_ID }}"
    aws_secret_access_key: "{{ aws_creds.AWS_SECRET_ACCESS_KEY }}"



    # –ü–µ—Ä–µ–¥–∞—ë–º IP –¥—Ä—É–≥–∏—Ö –º–∞—à–∏–Ω —á–µ—Ä–µ–∑ inventory
    backend_ip: "{{ hostvars[groups['backend'][0]].backend_ip }}"
    frontend_ip: "{{ hostvars[groups['frontend'][0]].frontend_ip }}"
  roles:
    - monitoring
